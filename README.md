# Анализ лояльности пользователей Яндекс Афиши

## Введение

Команда маркетинга хочет лучше понимать поведение пользователей платформы. В рамках проекта проводится исследовательский анализ данных, направленный на выявление пользователей, которые с большей вероятностью возвращаются на платформу и совершают повторные заказы.  

Понимание этих закономерностей необходимо для повышения эффективности маркетинговых решений и более рационального использования ресурсов.  

В ходе работы анализируются данные о действиях пользователей и их заказах, чтобы определить ключевые поведенческие различия между разовыми и возвращающимися клиентами. Полученные выводы служат основой для дальнейших аналитических и прикладных шагов.

## Цели проекта

Ключевая цель проекта — определить, какие пользователи с наибольшей вероятностью возвращаются на платформу и делают повторные заказы, а также какие признаки и модели поведения этому способствуют.  

Результаты проекта позволяют:  
- Быстро выявлять перспективных клиентов и предлагать им персонализированные условия;  
- Точно настраивать рекламу на аудитории с высокой вероятностью возврата;  
- Оптимизировать маркетинговые бюджеты;  
- Повысить общий уровень удержания клиентов.

## Общий вывод и рекомендации

### Информация о данных

- Датасет содержит 290 611 записей и 15 столбцов. После предобработки осталось 287 177 строки: удалено 3 434 записей (≈1,18 %), что не оказывает существенного влияния на результаты анализа.  
- Пропуски встречаются только в `days_since_prev`, что логично для первых заказов пользователей.  
- Даты `order_dt` и `order_ts` приведены к типу `datetime64[ns]`. Категориальные признаки (`device_type_canonical`, `currency_code`, `event_type_main`) приведены к типу `category` для экономии памяти. Числовые столбцы оптимизированы:  
  - `revenue`, `revenue_rub`, `days_since_prev` → `float32`  
  - `tickets_count` → `int8`  
  - `order_id` → `int32`  
- Выручка пересчитана из `KZT` в `RUB` по дневному курсу с привязкой к дате заказа; результат сохранён в `revenue_rub`.  
  - Некорректные значения: 381 отрицательное значение удалено, 5 522 нулевых значений оставлены.  
  - Фильтрация выбросов выполнена по 99-му перцентилю.  
- Категориальные данные не требовали нормализации; пропусков и некорректных значений нет.  
- Анализ `tickets_count` показал, что большинство заказов содержит 1–5 билетов; редкие крупные заказы сохранены и не считались выбросами.  
- Пропуски в `days_since_prev` интерпретируются как признак первого заказа пользователя.  

**Итог:** данные очищены, приведены к единой валюте и оптимизированы, что обеспечивает корректность и устойчивость последующего анализа.

### Основные результаты анализа

- **Пользователи и заказы:** распределение неравномерное — основная часть пользователей совершает 1–4 заказа, сегмент 5+ заказов значительно меньше. Экстремальные значения (<1 %) удалены.  
- **Точки входа:** большинство первых заказов приходится на концерты (44 %), доминируют мобильные устройства (82,7 %), пользователи сконцентрированы в ограниченном числе регионов и операторов.  
- **Факторы возврата:** выше доля повторных заказов у пользователей, начавших с отдельных типов мероприятий, регионов и операторов. Высокие значения встречаются как в крупных, так и в малых сегментах (важен размер группы).  
- **Выручка и билеты:** возвратные пользователи в среднем тратят больше; максимальная доля повторных покупок — при 2–3 билетах; сегменты с 5+ билетами нестабильны из-за малого объёма.  
- **Время:** день недели первой покупки влияет слабо; ключевой фактор удержания — короткий и регулярный интервал между заказами.  
- **Корреляции с числом заказов:** наибольшая связь у `avg_days_between_orders` и `avg_tickets_count`; регион первого заказа влияет умеренно.  

**Итог:** удержание определяется частотой и регулярностью покупок, а не характеристиками первого заказа.

### Рекомендации

- **Приоритетные сегменты:** пользователи с короткими интервалами между заказами — ключевой драйвер удержания. Сегмент `2–4 заказа` — основной резерв для увеличения повторных покупок.  
- **Работа с лояльными клиентами:** пользователей с `5+ заказами` удерживать через программы лояльности и персональные предложения, без агрессивных скидок.  
- **Маркетинг и таргетинг:** использовать характеристики первого заказа (тип мероприятия, регион) для первичной сегментации и настройки рекламы; точечно работать с малыми сегментами с высокой долей возвратов, контролируя масштаб из-за нестабильности метрик.  
- **Триггерные механики:** запускать коммуникации при превышении привычного интервала между заказами, особенно для пользователей с `2–4 заказами`.  
- **Оптимизация бюджета:** не учитывать день недели первой покупки как значимый фактор; стимулировать заказы с `2–3 билетами` как наиболее устойчивый сегмент; не фокусироваться на редких крупных заказах (`5+ билетов`).  
- **Общий подход:** упор на поведенческие признаки (частота покупок, интервалы), а не на демографию или контекст первого заказа; сокращать расходы на одноразовых клиентов без признаков возврата.
